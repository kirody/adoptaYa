<div class="management-panel-container">
  <app-header-page [title]="'Panel de Gestión'" [icon]="'fas fa-cog'"></app-header-page>
  <!-- <div class="card flex justify-center content-spinner" *ngIf="isLoading">
    <p-progress-spinner strokeWidth="4" fill="transparent" animationDuration=".0.5s"
      [style]="{ width: '50px', height: '50px' }" />
  </div> -->
  <p-card header="Vistas Públicas" class="mb-4" *ngIf="user()?.role === 'ROLE_ADMIN'">
      <div class="flex flex-wrap gap-2">

        <p-button
          label="Ver Listado de Animales"
          icon="pi pi-eye"
          [routerLink]="['/animales']"
          styleClass="p-button-secondary p-button-sm">
        </p-button>

        <p-button
          label="Ver Listado de Protectoras"
          icon="pi pi-eye"
          [routerLink]="['/protectoras']"
          styleClass="p-button-secondary p-button-sm">
        </p-button>

        <p-button
          label="Ir al Inicio Público"
          icon="pi pi-home"
          [routerLink]="['/inicio']"
          styleClass="p-button-secondary p-button-sm">
        </p-button>

        </div>
    </p-card>
  <div class="card h-50" *ngIf="user">
    <p-tabs value="{{ valueTab }}" scrollable>
      <p-tablist>
        <ng-template #previcon>
          <i class="pi pi-minus"></i>
        </ng-template>
        <p-tab value="0" class="flex items-center !gap-2" (click)="tabAnimals()" *ngIf="canManageAnimals()">
          <i [ngClass]="{'fa fa-paw': user()?.role === 'ROLE_ADMIN', 'fa fa-clock': user()?.role === 'ROLE_MOD'}"></i> <!-- Mantener string aquí por la clase CSS -->
          <span class="font-bold whitespace-nowrap">{{user()?.role === 'ROLE_MOD' ? 'Pendientes publicar' :
            'Animales'}}</span>
          <p-progress-spinner *ngIf="isLoadingAnimalsCount()" strokeWidth="8" fill="transparent"
            animationDuration=".5s" [style]="{ width: '20px', height: '20px' }" />
          <p-tag *ngIf="!isLoadingAnimalsCount()" severity="warn" [value]="countTabAnimals" [rounded]="true" />
        </p-tab>
        <p-tab value="1" class="flex items-center !gap-2" *ngIf="canManageRequests()">
          <i class="fa fa-file"></i>
          <span class="font-bold whitespace-nowrap">Solicitudes</span>
          <p-progress-spinner *ngIf="isLoadingRequestsCount()" strokeWidth="8" fill="transparent"
            animationDuration=".5s" [style]="{ width: '20px', height: '20px' }" />
          <p-tag *ngIf="!isLoadingRequestsCount()" severity="warn" [value]="countTabRequests" [rounded]="true" />
        </p-tab>
        <p-tab value="2" class="flex items-center !gap-2" (click)="tabUsers()" *ngIf="canManageUsers()">
          <i class="fa fa-users"></i>
          <span class="font-bold whitespace-nowrap">Usuarios</span>
        </p-tab>
        <p-tab value="5" class="flex items-center !gap-2" (click)="tabProtectors()" *ngIf="canManageProtectors()">
          <i class="fa fa-shield-alt"></i>
          <span class="font-bold whitespace-nowrap">Protectoras</span>
          <p-tag *ngIf="!isLoading" severity="info" [value]="dataTable().length" [rounded]="true" />
        </p-tab>
        <p-tab value="4" class="flex items-center !gap-2" (click)="tabLogs()" *ngIf="canManageLogs()">
          <i class="fa fa-history"></i>
          <span class="font-bold whitespace-nowrap">Registro</span>
        </p-tab>
        <p-tab value="3" class="flex items-center !gap-2" *ngIf="['ROLE_ADMIN'].includes(user()?.role)">
          <i class="fa fa-file"></i>
          <span class="font-bold whitespace-nowrap">Estadísticas</span>
        </p-tab>
        <ng-template #nexticon>
          <i class="pi pi-plus"></i>
        </ng-template>
      </p-tablist>
      <p-tabpanels>
        <p-tabpanel value="0">
          <app-animals-table [dataTable]="dataTable()" [isLoading]="isLoading" [user]="user()"
            (dataChanged)="reloadData()" [initialFilter]="initialAnimalFilter"></app-animals-table>
        </p-tabpanel>
        <p-tabpanel value="1">
          <app-requests></app-requests>
        </p-tabpanel>
        <p-tabpanel value="2">
          <app-users-table [dataTable]="dataTable()" [isLoading]="isLoading" [user]="user()"
            (dataChanged)="reloadData()"></app-users-table>
        </p-tabpanel>
        <p-tabpanel value="5">
          <app-protectors-table (dataChanged)="reloadData()"></app-protectors-table>
        </p-tabpanel>
        <p-tabpanel value="3">
          <app-statistics></app-statistics>
        </p-tabpanel>
        <p-tabpanel value="4">
          <app-log></app-log>
        </p-tabpanel>

        <p-tabpanel value="20">
          <p-message severity="warn" styleClass="w-full">
            <div class="flex align-items-center">
              <i class="pi pi-lock mr-3" style="font-size: 1.5rem"></i>
              <span>No tienes permisos para gestionar.</span>
            </div>
          </p-message>
        </p-tabpanel>
      </p-tabpanels>
    </p-tabs>
  </div>
</div>

<p-toast />
<p-confirmdialog />
